<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ServiceMapper">

<insert id="insertServiceArea" parameterType="com.smhrd.model.tb_service_area">
	insert into tb_service_area values(#{sa_name},#{sa_type},#{sa_addr},#{lat},#{lon},#{sa_img1},#{sa_img2},#{sa_img3},#{created_at},#{updated_at})
</insert>

<select id="existServiceArea" resultType="com.smhrd.model.tb_service_area">
	select*from tb_service_area where sa_name = #{sa_name}	
</select>

<select id="getServiceArea" resultType="com.smhrd.model.tb_service_area">
	select*from tb_service_area
</select>


<insert id="insertDetails" parameterType="com.smhrd.model.tb_details">
	insert into tb_details values(
	#{sa_name},
	#{parking_space},
	#{is_car_maintenance},
	#{is_gas_station},
	#{is_lpg_station},
	#{is_ev_charge},
	#{is_break_room},
	#{is_rest_room},
	#{is_drug_store},
	#{is_nursinng_room},
	#{is_snack_bar},
	#{is_restaurant},
	#{is_hydrogen_charge},
	#{created_at}
	)	
</insert>

<select id="existDetails" resultType="com.smhrd.model.tb_details">
	select*from tb_details where sa_name = #{sa_name}
</select>


<insert id="insertAdmin" parameterType="com.smhrd.model.tb_admin">
	insert into tb_admin values(#{admin_id},#{admin_pw},#{admin_tel},#{sa_name},#{sa_addr},#{admin_position})
</insert>

<select id="login" parameterType="com.smhrd.model.tb_admin" resultType="com.smhrd.model.tb_admin">
	select * from tb_admin where admin_id = #{admin_id} and admin_pw = #{admin_pw}
</select>

<select id="existAdminId" parameterType="string" resultType="int">
        SELECT COUNT(*) FROM tb_admin WHERE admin_id = #{admin_id, jdbcType=VARCHAR}
    </select>

<select id="getTrips" resultType="com.smhrd.model.domestic_trips">
	select*from domestic_trips
</select>

<select id="getAllTourism" resultType="com.smhrd.model.TourismStats">
	select * from TourismStats
</select>

<select id="getAllTourismGrowth" resultType="com.smhrd.model.RegionalTourismGrowth">
	select * from RegionalTourismGrowth 
</select>

 <select id="getAddrByRegion" parameterType="string" resultType="string">
        SELECT sa_name FROM tb_service_area WHERE CONTAINS(sa_addr, #{region}, 1) > 0
    </select>

<select id="getServiceAreaBySaName" resultType="com.smhrd.model.tb_service_area">
	select * from tb_service_area where sa_name = #{sa_name}
</select>

<select id="getFacility" resultType="com.smhrd.model.tb_details">
	select * from tb_details where sa_name = #{sa_name}
</select>

<select id="getSuggestion" resultType="com.smhrd.model.tb_suggestion">
	select * from tb_suggestion where sa_name = #{sa_name}
</select>

<insert id="insertSuggestion" parameterType="com.smhrd.model.tb_suggestion">
	INSERT INTO tb_suggestion (suggestion_title, suggestion_content, sa_name, suggestion_publisher)
    VALUES (#{suggestion_title}, #{suggestion_content}, #{sa_name}, #{suggestion_publisher})
</insert>

<select id="getInsertedSuggestionId" resultType="com.smhrd.model.tb_suggestion">
    SELECT * 
	FROM (
	    SELECT * 
	    FROM tb_suggestion 
	    ORDER BY suggestion_idx DESC
	) 
	WHERE ROWNUM = 1
</select>

<update id="updateProfile" parameterType="com.smhrd.model.tb_admin">
    UPDATE tb_admin
    SET 
        admin_pw = #{admin_pw},          -- 비밀번호
        admin_tel = #{admin_tel},        -- 전화번호
        sa_name = #{sa_name},            -- 휴게소 이름
        sa_addr = #{sa_addr},            -- 주소
        admin_position = #{admin_position}           -- 직책
    WHERE 
        admin_id = #{admin_id}           -- 조건: admin_id가 일치하는 행만 업데이트
</update>





<select id="getSuggestionByIdx" resultType="com.smhrd.model.tb_suggestion">
	select * from tb_suggestion where suggestion_idx = #{suggestion_idx}
</select>

</mapper>